# scripts/manage_data.py
import sys
import os

# 1. ë¶€ëª¨ ë””ë ‰í† ë¦¬(ë£¨íŠ¸)ë¥¼ ê²½ë¡œì— ì¶”ê°€ (app, database ë“±ì„ ë¶ˆëŸ¬ì˜¤ê¸° ìœ„í•¨)
# sys.path.append(os.path.dirname(os.path.abspath(os.path.dirname(__file__))))
sys.path.append(os.getcwd())

from app import app
from app.database import db
from app.models import TypingText

def seed_texts():
    """ì´ˆê¸° ìƒ˜í”Œ ë°ì´í„°ë¥¼ DBì— ì‚½ìž…í•˜ëŠ” í•¨ìˆ˜"""
 

    samples = [
    TypingText(genre='proverb', title='ê³µìž', author='ê³µìž', content='ë°°ìš°ê³  ë•Œë¡œ ìµížˆë©´ ë˜í•œ ì¦ê²ì§€ ì•„ë‹ˆí•œê°€.'),
    TypingText(genre='poem', title='ì„œì‹œ', author='ìœ¤ë™ì£¼', content='ì£½ëŠ” ë‚ ê¹Œì§€ í•˜ëŠ˜ì„ ìš°ëŸ¬ëŸ¬ í•œ ì  ë¶€ë„ëŸ¼ ì—†ê¸°ë¥¼...'),
    TypingText(genre='novel', title='ì–´ë¦°ì™•ìž', author='ìƒí…ì¥íŽ˜ë¦¬', content='ê°€ìž¥ ì¤‘ìš”í•œ ê²ƒì€ ëˆˆì— ë³´ì´ì§€ ì•Šì•„.'),
    TypingText(genre='k-pop', title='ë´„ë‚ ', author='BTS', content='ë³´ê³  ì‹¶ë‹¤\nì´ë ‡ê²Œ ë§í•˜ë‹ˆê¹Œ ë” ë³´ê³  ì‹¶ë‹¤\në„ˆí¬ ì‚¬ì§„ì„ ë³´ê³  ìžˆì–´ë„\në³´ê³  ì‹¶ë‹¤\në„ˆë¬´ ì•¼ì†í•œ ì‹œê°„\në‚˜ëŠ” ìš°ë¦¬ê°€ ë°‰ë‹¤\nì´ë³„ì´ ì´ëŸ° ê±´ê°€\në„ˆë¬´ ë©€ë¦¬ ë– ë‚˜ê°„ë‹¤\në‚ ì”¨ê°€ ì¢‹ì€ ë‚ ì—\nê±·ê³  ì‹¶ì–´\ní•œê°•ì— ì•‰ì•„ì„œ\në„ˆì™€ ì´ì•¼ê¸°í•˜ê³  ì‹¶ì–´\në³´ê³  ì‹¶ë‹¤\nì´ë ‡ê²Œ ë§í•˜ë‹ˆê¹Œ ë” ë³´ê³  ì‹¶ë‹¤\në„ˆí¬ ì‚¬ì§„ì„ ë³´ê³  ìžˆì–´ë„\në³´ê³  ì‹¶ë‹¤\në„ˆë¬´ ì•¼ì†í•œ ì‹œê°„\në‚˜ëŠ” ìš°ë¦¬ê°€ ë°‰ë‹¤\nì´ë³„ì´ ì´ëŸ° ê±´ê°€\në„ˆë¬´ ë©€ë¦¬ ë– ë‚˜ê°„ë‹¤\në‚ ì”¨ê°€ ì¢‹ì€ ë‚ ì—\nê±·ê³  ì‹¶ì–´\ní•œê°•ì— ì•‰ì•„ì„œ\në„ˆì™€ ì´ì•¼ê¸°í•˜ê³  ì‹¶ì–´'),
    TypingText(genre='k-pop', title='ì¢‹ì€ ë‚ ', author='ì•„ì´ìœ ', content='í•˜ë£¨í•˜ë£¨ ë©°ì¹ ì´ ì§€ë‚˜ê³ \nìš°ë¦¬ì˜ ê·¸ë•Œ ê·¸ ì¶”ì–µì„\në‚œ ì•„ì§ë„ ê¸°ì–µí•´\në‚œ ë„ˆë¥¼ ê¸°ì–µí•´\nê·¸ë•Œë¡œ ë‹¤ì‹œ ëŒì•„ê°€ê³  ì‹¶ì–´\në‚œ ë„ˆë¥¼ ê¸°ì–µí•´\nê·¸ë•Œë¡œ ë‹¤ì‹œ ëŒì•„ê°€ê³  ì‹¶ì–´\ní•˜ë£¨í•˜ë£¨ ë©°ì¹ ì´ ì§€ë‚˜ê³ \nìš°ë¦¬ì˜ ê·¸ë•Œ ê·¸ ì¶”ì–µì„\në‚œ ì•„ì§ë„ ê¸°ì–µí•´\në‚œ ë„ˆë¥¼ ê¸°ì–µí•´\nê·¸ë•Œë¡œ ë‹¤ì‹œ ëŒì•„ê°€ê³  ì‹¶ì–´\në‚œ ë„ˆë¥¼ ê¸°ì–µí•´\nê·¸ë•Œë¡œ ë‹¤ì‹œ ëŒì•„ê°€ê³  ì‹¶ì–´'),
    
    TypingText(genre='k-pop', title='ì—ìž‡', author='ì•„ì´ìœ ', content='ì´ëŸ° ì•…ëª½ì´ë¼ë©´ ê¿ˆì„ ê¹¨ê³  ì‹¶ì–´\në‚œ ê·¸ ì†ì˜ ì±„ì›Œì§€ì§€ ì•ŠëŠ” ê¿ˆì„ ê¾¸ê³  ì‹¶ì–´\nê¿ˆì†ì—ì„œë¼ë„ ë„ˆì™€ í•¨ê»˜ í•˜ê³  ì‹¶ì–´\nì´ëŸ° ì•…ëª½ì´ë¼ë©´ ê¿ˆì„ ê¹¨ê³  ì‹¶ì–´\në‚œ ê·¸ ì†ì˜ ì±„ì›Œì§€ì§€ ì•ŠëŠ” ê¿ˆì„ ê¾¸ê³  ì‹¶ì–´\nê¿ˆì†ì—ì„œë¼ë„ ë„ˆì™€ í•¨ê»˜ í•˜ê³  ì‹¶ì–´'),
    
    TypingText(genre='k-pop', title='ì‹ í˜¸ë“±', author='ì´ë¬´ì§„', content='ì‹ í˜¸ë“± ì•žì—ì„œ ë©ˆì¶° ì„œ ìžˆë„¤\në¹¨ê°„ ë¶ˆì´ ì¼œì§€ë©´ ê¸°ë‹¤ë ¤ì•¼ í•´\níŒŒëž€ ë¶ˆì´ ì¼œì§€ë©´ ê·¸ë•Œ ê°€ë©´ ë¼\nì‹ í˜¸ë“± ì•žì—ì„œ ë©ˆì¶° ì„œ ìžˆë„¤\në¹¨ê°„ ë¶ˆì´ ì¼œì§€ë©´ ê¸°ë‹¤ë ¤ì•¼ í•´\níŒŒëž€ ë¶ˆì´ ì¼œì§€ë©´ ê·¸ë•Œ ê°€ë©´ ë¼\nì‹ í˜¸ë“± ì•žì—ì„œ ë©ˆì¶° ì„œ ìžˆë„¤\në¹¨ê°„ ë¶ˆì´ ì¼œì§€ë©´ ê¸°ë‹¤ë ¤ì•¼ í•´\níŒŒëž€ ë¶ˆì´ ì¼œì§€ë©´ ê·¸ë•Œ ê°€ë©´ ë¼'),
    
    TypingText(genre='k-pop', title='ë‚˜ì˜ ì˜›ë‚ ì´ì•¼ê¸°', author='í˜ì˜¤', content='ë‚˜ì˜ ì˜›ë‚ ì´ì•¼ê¸°\në‚˜ì˜ ì˜›ë‚ ì´ì•¼ê¸°\në‚˜ì˜ ì˜›ë‚ ì´ì•¼ê¸°\në‚˜ì˜ ì˜›ë‚ ì´ì•¼ê¸°\në‚˜ì˜ ì˜›ë‚ ì´ì•¼ê¸°\në‚˜ì˜ ì˜›ë‚ ì´ì•¼ê¸°\në‚˜ì˜ ì˜›ë‚ ì´ì•¼ê¸°\në‚˜ì˜ ì˜›ë‚ ì´ì•¼ê¸°'),
    TypingText(genre='k-pop', title='ë¼ì¼ë½', author='ì•„ì´ìœ ', content='ì˜¤ëŠ˜ì€ ê·¸ëƒ¥ ê°€ë³ê²Œ\në¼ì¼ë½ ê½ƒí–¥ê¸°ë§Œ ë§¡ê³  ì‹¶ì–´\nì˜¤ëŠ˜ì€ ê·¸ëƒ¥ ê°€ë³ê²Œ\në¼ì¼ë½ ê½ƒí–¥ê¸°ë§Œ ë§¡ê³  ì‹¶ì–´\nì˜¤ëŠ˜ì€ ê·¸ëƒ¥ ê°€ë³ê²Œ\në¼ì¼ë½ ê½ƒí–¥ê¸°ë§Œ ë§¡ê³  ì‹¶ì–´\nì˜¤ëŠ˜ì€ ê·¸ëƒ¥ ê°€ë³ê²Œ\në¼ì¼ë½ ê½ƒí–¥ê¸°ë§Œ ë§¡ê³  ì‹¶ì–´'),
    
    TypingText(genre='k-pop', title='Love poem', author='ì•„ì´ìœ ', content='ëˆ„êµ°ê°€ê°€ ë„ˆë¥¼ ì‚¬ëž‘í•˜ê³  ìžˆë„¤\nëˆ„êµ°ê°€ê°€ ë„ˆë¥¼ ì‚¬ëž‘í•˜ê³  ìžˆë„¤\nëˆ„êµ°ê°€ê°€ ë„ˆë¥¼ ì‚¬ëž‘í•˜ê³  ìžˆë„¤\nëˆ„êµ°ê°€ê°€ ë„ˆë¥¼ ì‚¬ëž‘í•˜ê³  ìžˆë„¤\nëˆ„êµ°ê°€ê°€ ë„ˆë¥¼ ì‚¬ëž‘í•˜ê³  ìžˆë„¤\nëˆ„êµ°ê°€ê°€ ë„ˆë¥¼ ì‚¬ëž‘í•˜ê³  ìžˆë„¤\nëˆ„êµ°ê°€ê°€ ë„ˆë¥¼ ì‚¬ëž‘í•˜ê³  ìžˆë„¤\nëˆ„êµ°ê°€ê°€ ë„ˆë¥¼ ì‚¬ëž‘í•˜ê³  ìžˆë„¤'),
    TypingText(genre='k-pop', title='ë°¤íŽ¸ì§€', author='ì•„ì´ìœ ', content='ì´ ë°¤ì„ ì§€ë‚˜ê°„ë‹¤\në„ˆë¥¼ ìƒê°í•˜ë©°\nì´ ë°¤ì„ ì§€ë‚˜ê°„ë‹¤\në„ˆë¥¼ ìƒê°í•˜ë©°\nì´ ë°¤ì„ ì§€ë‚˜ê°„ë‹¤\në„ˆë¥¼ ìƒê°í•˜ë©°\nì´ ë°¤ì„ ì§€ë‚˜ê°„ë‹¤\në„ˆë¥¼ ìƒê°í•˜ë©°')
    ]

    with app.app_context():
        # ì¤‘ë³µ ë°©ì§€ë¥¼ ìœ„í•´ ì œëª©ì´ ì—†ëŠ” ê²ƒë§Œ ì¶”ê°€
        for sample in samples:
            exists = TypingText.query.filter_by(title=sample.title).first()
            if not exists:
                db.session.add(sample)
        
        db.session.commit()
        print(f"âœ… {len(samples)}ê°œì˜ ìƒ˜í”Œ ë°ì´í„° ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.")

def clear_texts():
    """DBì˜ ëª¨ë“  í…ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì§€ìš°ëŠ” í•¨ìˆ˜ (í…ŒìŠ¤íŠ¸ìš©)"""
    with app.app_context():
        num = db.session.query(TypingText).delete()
        db.session.commit()
        print(f"ðŸ—‘ {num}ê°œì˜ ë°ì´í„°ë¥¼ ì‚­ì œí–ˆìŠµë‹ˆë‹¤.")

if __name__ == "__main__":
    # í„°ë¯¸ë„ì—ì„œ ì‹¤í–‰ ì‹œ ìž‘ë™
    if len(sys.argv) > 1 and sys.argv[1] == "clear":
        clear_texts()
    else:
        seed_texts()